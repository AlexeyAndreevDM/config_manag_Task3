# Ассемблер и интерпретатор для учебной виртуальной машины. Вариант №2.

### Этап 2: Формирование машинного кода

#### Общее описание
Реализован транслятор из промежуточного представления в машинный код УВМ. Ассемблер преобразует структурированные команды в бинарный формат и записывает результат в двоичный файл.

#### Реализованные функции
- Кодирование инструкций в машинное представление (4 байта на инструкцию)
- Запись бинарного файла с машинным кодом
- Вывод количества ассемблированных команд
- Вывод машинного кода в байтовом формате в режиме тестирования

#### Команды для запуска

**Основной ассемблер:**
```bash
python main.py <входной_файл.json> <выходной_файл.bin> [--test]
```

**Тестирование этапа 2:**
```bash
python test_stage2.py
```

#### Пример использования

**Входной файл program.json:**
```json
[
    {"opcode": 22, "B": 722},
    {"opcode": 62, "B": 541},
    {"opcode": 26, "B": 34},
    {"opcode": 45, "B": 94}
]
```

**Запуск базовый**
```bash
python main.py program.json program.bin
```

**Запуск скрипта для тестирования:**
```bash
python test_stage2.py
```

**Запуск в режиме тестирования:**
```bash
python main.py test.json program.bin --test
```

**Ожидаемый вывод:**
```
Запуск ассемблера УВМ
   Входной файл: test.json
   Выходной файл: program.bin
   Режим тестирования: ВКЛ
Число ассемблированных команд: 4
Внутреннее представление программы:
   Инструкция 0: A=22, B=722
   Инструкция 1: A=62, B=541
   Инструкция 2: A=26, B=34
   Инструкция 3: A=45, B=94

Сравнение с тестовыми примерами из спецификации УВМ:
   Тест 0: СОВПАДАЕТ (A=22, B=722)
   Тест 1: СОВПАДАЕТ (A=62, B=541)
   Тест 2: СОВПАДАЕТ (A=26, B=34)
   Тест 3: СОВПАДАЕТ (A=45, B=94)
Все тестовые примеры из спецификации УВМ пройдены успешно!

Машинный код программы:
   Инструкция 0: 0x96, 0xB4, 0x00, 0x00
   Инструкция 1: 0xBE, 0x87, 0x00, 0x00
   Инструкция 2: 0x9A, 0x00, 0x00, 0x00
   Инструкция 3: 0xAD, 0x17, 0x00, 0x00
Ассемблирование завершено успешно
```

#### Соответствие спецификации УВМ
Машинный код соответствует тестовым последовательностям из спецификации:
- Загрузка константы (A=22, B=722): 0x96, 0xB4, 0x00, 0x00
- Чтение из памяти (A=62, B=541): 0xBE, 0x87, 0x00, 0x00
- Запись в память (A=26, B=34): 0x9A, 0x00, 0x00, 0x00
- Умножение (A=45, B=94): 0xAD, 0x17, 0x00, 0x00

#### Примечания
- Каждая инструкция кодируется в 4 байта
- Бинарный файл содержит последовательность машинных команд
- В режиме тестирования выводится байтовое представление каждой инструкции